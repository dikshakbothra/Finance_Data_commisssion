P_x1to3 = integrate(fx,1,3)$value
print(P_x1to3)   #prob of X greater than 12
px1by2 = integrate(fx,1/2,Inf)$value
cat("prob of X more than 0.5 is",px1by2)
Fx = integrate(fx,0,x)
return(1 - 4/(a^2))
#Example 19 chapter 2 page no. 76
Fx<-function(a){                     #prob density function
return(1 - 4/(a^2))
}
P_x3 = Fx(3)
print(P_x3)   #prob of X less than equal to 3
cat("prob of 4<=x<=5 is",Fx(5)-Fx(4))
#Example 11 chapter 2 page no 69
func<-function(x){
1/(1+x^2)
}
k=1/integrate(func,lower=-Inf,upper=Inf)$value
print(k)
7/22
P_AorB = 1 - (1-P_A)*(1-P_B)
#Example 31 chapter 1 page no 32
P_A = 2/3    # prob of white ball from bag1
P_B = 2/4     #prob of white ball from bag 1
P_AorB = 1 - (1-P_A)*(1-P_B)
cat("prob of atleast 1 white",P_AorB)
#Example 31 chapter 1 page no 32
P_A = 0.7    # prob of A speak truth
P_B = 0.65     #prob of B speak truth
P_AandB = P_A*P_B
P_AandBbar = P_A*(1-P_B)
P_AbarandB = (1-P_A)*P_B
P_AbarandBbar = (1-P_A)*(1-P_B)
cat("prob of A and B in contradiction state",P_AandBbar+P_AbarandB)
#Example 27 chapter 1 page no 30
P_A = 4/36    # prob of sum=5 on rolling 2 dice
P_B = 6/36     #prob of sum=7 on rolling 2 dice
lemda = 1-(P_A+P_B)    # prob neither 5 nor 7 as the sum
cat("prob of sum=5 to come before",P_A/(1-lemda))
#Example 29 chapter 1 page no 30
P_A=1/3    # prob that A hits the target
P_B=1/5
cat("prob that both hits the target",P_A*P_B)
1/15
cat("prob of atleast one hit the target"P_A+P_B-P_A*P_B)
cat("prob of atleast one hit the target",P_A+P_B-P_A*P_B)
7/15
cat("prob of no one hit the target",1-(P_A+P_B-P_A*P_B))
8/15
#Example 24 chapter 1 page no 28
PABC=c(500,300,200)
P_A = PABC[1]/sum(PABC)
P_B = PABC[2]/sum(PABC)
P_C = PABC[3]/sum(PABC)
P_DwhenA=1/100
P_DwhenB=2/100
P_DwhenC=4/100
P_AwhenD=P_DwhenA*P_A/(P_DwhenA*P_A+P_DwhenB*P_B+P_DwhenC*P_C)
print(P_AwhenD)
integrate(dnorm,0,1)
integrate(pnorm,0,1)
integrate(integrate(pnorm,0,1),0,1)
a=10
b=9
c=-1
k1<-(-b + sqrt(b^2 - 4*a*c))/(2*a)
k2<-(-b - sqrt(b^2 - 4*a*c))/(2*a)
print(k2)    #selecting k2 as the value of k
print(k1)    #selecting k1 as the value of k
#Example 25 chapter 2 page no.85
a=10     #for euation 10k^2 + 9k -1 = 0
#Example 25 chapter 2 page no.85
X=c(0:7)
k=k1
P_X = c(0,k,2*k,2*k,3*k,k*k,2*k*k,7*k*k+k)
P_X[4]+P_X[5]/P_X[4]+P_X[5]+P_X[6]+P_X[7]+P_X[8]
P_X[4]+P_X[5]/(P_X[4]+P_X[5]+P_X[6]+P_X[7]+P_X[8])
5/7
P_X[4]
P_X[5]
P_X[4]+P_X[5]/(1-P_X[1]-P_X[2]-P_X[3])
(P_X[4]+P_X[5])/(1-P_X[1]-P_X[2]-P_X[3])
cat("prob of 1.5<x<4.5 when prob of x>2",(P_X[4]+P_X[5])/(1-P_X[1]-P_X[2]-P_X[3])
cat("prob of 1.5<x<4.5 when prob of x>2",(P_X[4]+P_X[5])/(1-P_X[1]-P_X[2]-P_X[3]))
cat("prob of 1.5<x<4.5 when prob of x>2",(P_X[4]+P_X[5])/(1-P_X[1]-P_X[2]-P_X[3]))
costA=8*15*l/(u-l)+8*8
#Example7 chapter 7 page no 301
l= 5 #break downs per hout
u=7    #repairs per hour
cat("avg units per hour",l/(u-l))
cat("loss due to machines idle",8*15*l/(u-l))
cat("repair man charge",8*8)
costA=8*15*l/(u-l)+8*8
u2=9
cat("avg units per hour for B",l/(u2-l))
cat("loss due to machines idle for B",8*10*l/(u2-l))
cat("loss due to machines idle for B",8*15*l/(u2-l))
costB =8*15*l/(u2-l) +10*8
cat("cost of A",costA,"\ncost of B",costB)
#Example 9 chapter 7 page no 309
l =3     # arrival rate per hour
u=50/36      #service rate customers per hour
N=4    # maximum 4 customers in the queue
rho = l/u
p0=(1-rho)/(1-rho^(N+1))
p0=(1-rho)/(1-(rho^(N+1)))
rho
u
u=60/36      #service rate customers per hour
N=4    # maximum 4 customers in the queue
rho = l/u
p0=(1-rho)/(1-(rho^(N+1)))
cat("Prob of no customer",p0)
En=(rho/(1-rho))*(1 - (N+1)*(rho^(N+1))*(1-rho)/(1-rho^(N+1))
En=(rho/(1-rho))*(1 - (N+1)*(rho^(N+1))*(1-rho)/(1-rho^(N+1)))
En=(rho/(1-rho))*(1 - (N+1)*(rho^(N+1))*(1-rho)/(1-rho^(N+1)))
cat("avg no of customer in the system",En)
rho
En=(rho/(1-rho))*(1 - ((N+1)*(rho^(N+1))*(1-rho)/(1-rho^(N+1))))
cat("avg no of customer in the system",En)
En=(rho/(1-rho))*(1 - ((N+1)*(rho^(N+1))*(1-rho)/(1-(rho^(N+1)))))
cat("avg no of customer in the system",En)
5*(9^5)/(5^5 - 9^5)
(rho/(1-rho))
((N+1)*(rho^(N+1))*(1-rho)/(1-(rho^(N+1))))
4.223518*2.25
5.279397*1.8
cat("avg no of customer in the system",round(En,0))
#Example 9 chapter 7 page no 309
l =6     # arrival rate trains per hour
u=12      #service rate trains per hour
N=3    # maximum 3 in the queue
rho = l/u
p0=(1-rho)/(1-(rho^(N+1)))
cat("Prob of no customer",p0)
cat("Prob of no train",p0)
cat("Prob of 1 train",p0*rho)
cat("Prob of 2 train",p0*rho^2)
cat("Prob of 3 train",p0*rho^3)
En=(rho/(1-rho))*(1 - ((N+1)*(rho^(N+1))*(1-rho)/(1-(rho^(N+1)))))
cat("avg no of customer in the system",round(En,0))
cat("avg no of train in the system",round(En,0))
ws = En/(u*(1-p0))
cat("avg waiting time in minutes"ws*60)
cat("avg waiting time in minutes",ws*60)
En
En=p1+2*p2+3*p3
cat("avg no of train in the system",round(En,0))
ws = En/(u*(1-p0))
cat("avg waiting time in minutes",ws*60)
En
En=p1+(2*p2)+(3*p3)
cat("avg no of train in the system",round(En,0))
ws = En/(u*(1-p0))
cat("avg waiting time in minutes",ws*60)
ws
2*0.13  + 3*0.07  +0.27
cat("Prob of no train",p0)
cat("Prob of 1 train",p0*rho)
cat("Prob of 2 train",p0*rho^2)
cat("Prob of 3 train",p0*rho^3)
p1=p0*rho
p2=p0*rho^2
cat("Prob of 2 train",p0*rho^2)
p3=p0*rho^3
cat("Prob of 3 train",p0*rho^3)
En=p1+(2*p2)+(3*p3)
cat("avg no of train in the system",round(En,0))
ws = En/(u*(1-p0))
cat("avg waiting time in minutes",ws*60)
#Example 28 chapter 4 page no 191
x=c(0:10)
f=c(1,4,15,22,21,20,8,6,2,0,1)
xbar=x%*%f
px=dpois(5,xbar)
exf=round(px*sum(f),0)
expectedfreq=round(px*sum(f),0)
df=data.frame(x,expectedfreq)
cat("expected freq are",df)
print("expected freq are",df)
print("expected freq are")
print(df)
px=dpois(5,xbar)
px*100
px=dpois(x,xbar)
expectedfreq=round(px*sum(f),0)
df=data.frame(x,expectedfreq)
print("expected freq are")
print(df)
px
px*100
px=ppois(x,xbar)
expectedfreq=round(px*sum(f),0)
df=data.frame(x,expectedfreq)
print("expected freq are")
print(df)
px
px=ppois(x,xbar)
px
factorial(0)
exp(-4)
dpois(0,4)
xbar=x%*%f/sum(f)
px=ppois(x,xbar)
expectedfreq=round(px*sum(f),0)
df=data.frame(x,expectedfreq)
print("expected freq are")
print(df)
dpois(1,4)
xbar
px=dpois(x,xbar)
expectedfreq=round(px*sum(f),0)
df=data.frame(x,expectedfreq)
print("expected freq are")
print(df)
#Example 27 chapter 4 page no 190
x=c(0:4)
days=c(21,18,7,3,1)
xbar=x%*%days/sum(days)
px=dpois(x,xbar)
expectedfreq=round(px*sum(days),2)
df=data.frame(x,expectedfreq)
print("expected freq are")
print(df)
p0=dpois(0,m)
#Example 22 chapter 4 page no 188
n=10
p=1/100
m=n*p
p0=dpois(0,m)
cat("prob of no defective blade",p0)
p0=round(dpois(0,m),3)
cat("prob of no defective blade",p0)
p1=round(dpois(1,m),3)
cat("prob of one defective blade",p1)
p1=round(dpois(1,m),4)
cat("prob of one defective blade",p1)
cat("prob of two defective blade",p2)
p2=round(dpois(2,m),3)
cat("prob of two defective blade",p2)
p2=round(dpois(2,m),4)
p2=round(dpois(2,m),4)
cat("prob of two defective blade",p2)
cat("packets with 0 defective blade",10000*p0)
cat("packets with 1 defective blade",10000*p1)
cat("packets with 2 defective blade",10000*p2)
#Example 13 chapter 4 page no176
p=0.1
n=20
x=c(0:20)
P=dbinom(x,n,p)
P_xmorethan5=1-(P[1]+P[2]+P[3]+P[4]+P[5])
print(P_xmorethan5)
#Example 21 chapter 3 page no. 122
P<-function(x){
return(nrow(combn(3,x))/8)
}
D((1+exp(t))^3)/8
D((1+exp(0))^3)/8
D((1+exp(t))^3,name = t)/8
D((1+exp(0))^3,name = t)/8
D((1+exp(0))^3,name = 't')/8
D((1+exp(t))^3,name = 't')/8
D((1+exp('t'))^3,name = 't')/8
D((1+exp('1'))^3,name = 't')/8
D((1+exp(1))^3,name = 't')/8
D((1+exp(2))^3,name = 't')/8
D((1+exp(t))^3,name = 't')/8
#Example 15 chapter 3 page no. 110
x=c(-2:3)
k=0.4/6
px=c(0.1,k,0.2,2*k,0.3,3*k)
Ex=x%*%px
print(Ex)
#Example 17 chapter 3 page no 111
Fx<-function(x){
exp(-x/6)/6
}
integrate(x*Fx,0,Inf)
integrate(Fx,0,Inf)
#Example 17 chapter 3 page no 111
Fx<-function(x){
(1/6)*x*exp(-x/6)
}
integrate(Fx,0,Inf)
En=integrate(Fx,0,Inf)$value
cat("expected lifetime",En)
variance<-function(x){
(1/6)*((x-En)^2)*exp(-x/6)
}
v=integrate(variance,0,Inf)
cat("variance of X",v)
cat("variance of X",v$value)
#Example 18 chapter 3 page no 113
X=c(3:6)
#Example 18 chapter 3 page no 113
X=c(3:6)
PX=c(1/8,5/8,2/8,0)
gx=c(10000,2500,-7000,0)
EgX=PX%*%gx
cat("ecpected profit of rs",EgX)
y=c(12,10.5,10,8,7,8,7.5,8.5,9)
#Example 14 chapter 6 page no 254
x=c(0:8)
fit<-lm(y~poly(x,2,raw = "True"))
plot(x,y,main = "scatterplot")
parabola=fit$coefficient[3]*x^2 + fit$coefficient[2]*x +fit$coefficient[1]
lines(x,parabola,col="red")
cat("y =",fit$coefficient[3],"x^2 +",fit$coefficient[2],"x +",fit$coefficient[1])
y=predict(fit,data.frame(x=6.5))
cat(y,"predicted drying time in hours for x=6.5gms")
#Example 11 chapter 6 page no 248
x=c(68,64,75,50,64,80,75,40,55,64)
rxi = rank(x)
y=c(62,58,68,45,81,60,68,48,50,74)
ryi = rank(y)
cor(rxi,ryi)
6/11
#Example 28 chapter 6 page no. 276
x=c(1:5)
y=c(2,5,3,8,7)
fit<-lm(y~poly(x,1,raw = "True"))
#Example 28 chapter 6 page no. 276
n=5
x=c(1:n)
y=c(2,5,3,8,7)
fit<-lm(y~poly(x,1,raw = "True"))
yi=predict(fit,data.frame(x))
error=sqrt(sum((y-yi)^2)/n)
cat("error of estimates",error)
#Example 13 chapter 7 page no 319
l1=14    #avg arrival rate for withdrawers
u1=20    #avg service rate for withdrawers
rho=l1/u1
Ew = l1/(u1*(u1-l1))
cat("avg waiting time in the queue",Ew*60)
cat("avg waiting time in the queue in minutes",Ew*60)
l2=16
Ew = l2/(u1*(u1-l1))
cat("avg waiting time in the queue for depositers in minutes",Ew*60)
Ew = l2/(u1*(u1-l2))
cat("avg waiting time in the queue for depositers in minutes",Ew*60)
l=l1+l2
c=2
P0=1/(1+  l/u  + (((l/u)^2)/2)*c*u1/(c*u1-l) )
l
P0=1/(1+  l/u1  + (((l/u1)^2)/2)*c*u1/(c*u1-l) )
EW=u1*((l/u1)^c)*P0/((c*u1-l)^2)
cat("avg waiting time in the queue in minutes for a withdrawer+depositer"Ew*60)
P0=1/(1+  l/u1  + (((l/u1)^2)/2)*c*u1/(c*u1-l) )
EW=u1*((l/u1)^c)*P0/((c*u1-l)^2)
cat("avg waiting time in the queue in minutes for a withdrawer+depositer",Ew*60)
cat("avg waiting time in the queue in minutes for a withdrawer+depositer",EW*60)
udash=120/7
u2=120/7
P0=1/(1+  l/u2  + (((l/u2)^2)/2)*c*u2/(c*u2-l) )
print(P0)
print(P0)
EW=u1*((l/u2)^c)*P0/((c*u2-l)^2)
cat("avg waiting time in the queue in minutes for a withdrawer+depositer",EW*60)
EW=u2*((l/u2)^c)*P0/((c*u2-l)^2)
cat("avg waiting time in the queue in minutes for a withdrawer+depositer",EW*60)
#Example 15 chapter 7 page no 322
l=10    #arrival rate vehicles per hour
c=2
u1=60/4    #service rate vehicles per hour
rho=l/u1
P0=1/(1+  l/u1  + (((l/u1)^2)/2)*c*u1/(c*u1-l) )
print(P0)
P_C=P0*(rho^2)*2*u1/(2*(2*u1-l))
cat("prob vehicle has to wait",P_C)
cat("prob of the day busy",l/(u1*c))
busy=l/(u1*c)
cat("pumps are idle for percentage = ",100*(1-busy))
#Example 16 chapter 7 page no 323
l=12    #arrival rate vehicles per hour
c=2
u1=60/6    #service rate customers per hour
rho=l/(u1*c)
P0=1/(1+  l/u1  + (((l/u1)^2)/2)*c*u1/(c*u1-l) )
print(P0)
P_C=P0*(rho^2)*2*u1/(2*(2*u1-l))
cat("prob vehicle has to wait",P_C)
P_C=P0*((l/u1)^2)*2*u1/(2*(2*u1-l))
cat("prob vehicle has to wait",P_C)
Em=P0*((l/u1)^2)*l*u1/((2*u1-l)^2)
cat("avg queue length",Em)
cat("avg customers in the system",Em +l/u1)
En=round(Em,0)
cat("avg customers in the system",En)
En=round(Em+l/u1,0)
cat("avg customers in the system",En)
Ev=En/l
cat("avg time spent in the system",Ev)
En=(Em+l/u1)
cat("avg customers in the system",round(En,0))
Ev=En/l
cat("avg time spent in the system",Ev)
cat("avg time spent in the system in minutes",Ev*60)
plain text
*italics*
*italics*
_italics_
install.packages(rmarkdown)
install.packages("rmarkdown")
library(rmarkdown)
plain text
cd<-read.csv("crimedata.csv",header = TRUE)
cd<-read.csv("/crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("\crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("F:\DIKSHA\Rfossee\report\crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("F:\\DIKSHA\Rfossee\report\crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("F:\\DIKSHA\\Rfossee\report\crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("F:\\DIKSHA\\Rfossee\report\\crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("F:\DIKSHA\Rfossee\report\crimedata.csv",header = TRUE,sep=",",quote = "\")
cd<-read.csv("F:\DIKSHA\Rfossee\report\crimedata.csv",header = TRUE,sep=",","\")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE)
cd<-read.csv("crimedata.csv",header = TRUE,"rt")
fire<-read.csv("firestations.csv",header = TRUE)
plot(cd$year,cd$total, type='o')
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cd<-read.csv("crimedata.csv",header = TRUE,sep=",")
cars <- c(1, 3, 6, 4, 9)
trucks <- c(2, 5, 4, 5, 12)
# Graph cars using a y axis that ranges from 0 to 12
plot(cars, type = "o", col = "blue", ylim = c(0, 12))
# Graph trucks with red dashed line and square points
lines(trucks, type = "o", pch = 22, lty = 2, col = "red")
# Create a title with a red, bold/italic font
title(main = "Autos", col.main = "red", font.main = 4)
# Create a legend in the upper left corner
legend("topleft", c("cars", "trucks"), cex = 0.8, col = c("blue", "red"), pch = 21:22,
lty = 1:2)
setwd("F:/DIKSHA/Rfossee/Finance_commission_dataset_31-05-2019")
ranchi<-read_excel("ranchi_data.xlsx")
library(readxl)
ranchi<-read_excel("ranchi_data.xlsx")
na_vec=which(!complete.cases(ranchi))
ranchi_clean=ranchi[-na_vec,]
unique(ranchi_clean$Block)
(ranchi_clean$Block)
ranchi_clean
ranchi_clean=ranchi[na_vec,]
(ranchi_clean$Block)
unique(ranchi_clean$Block)
ranchi<-read_excel("ranchi_data.xlsx")
na_vec=which(!complete.cases(ranchi))
ranchi_clean=ranchi[na_vec,]
unique(ranchi_clean$Block)
na.omit(unique(ranchi_clean$Block))
unique(ranchi_clean$Block)
x=unique(ranchi_clean$Block)
x[3:20]
x[3]="CHANHO"
x
x=unique(ranchi_clean$Block)
x=x[3:20]
x[3]="CHANHO"
x
library(readxl)
block<-read_excel("blocks.xlsx")
ranchi<-read_excel("ranchi_data.xlsx")
na_vec=which(!complete.cases(ranchi))
ranchi_clean=ranchi[na_vec,]
x=unique(ranchi_clean$Block)
x=x[3:20]
x[3]="CHANHO"
b=c(x,x)
b_rs=c(as.numeric(unlist(c(block[10])))/10000000,
as.numeric(unlist(c(block[15])))/10000000)
category=c(rep('Received',18),rep("Spent",18))
b_data=data.frame(category,b,b_rs)
library(ggplot2)
ggplot(b_data, aes(b, b_rs , fill = category)) +
geom_bar(stat="identity", position = "dodge") +
scale_fill_brewer(palette = "Set1") + labs(y="Amount (in Crores)") + ggtitle("Amount Recieved and Spent by each Block from 2015-19")
par(las=2)
ggplot(b_data, aes(b, b_rs , fill = category)) +
geom_bar(stat="identity", position = "dodge") +
scale_fill_brewer(palette = "Set1") + labs(y="Amount (in Crores)",
x="") + ggtitle("Amount Recieved and Spent by each Block from 2015-19")
par(lwd=2)
ggplot(b_data, aes(b, b_rs , fill = category)) +
geom_bar(stat="identity", position = "dodge") +
scale_fill_brewer(palette = "Set1") + labs(y="Amount (in Crores)",
x="") + ggtitle("Amount Recieved and Spent by each Block from 2015-19")
par(lwd=1)
ggplot(b_data, aes(b, b_rs , fill = category)) +
geom_bar(stat="identity", position = "dodge") +
scale_fill_brewer(palette = "Set1") + labs(y="Amount (in Crores)",
x="") + ggtitle("Amount Recieved and Spent by each Block from 2015-19")
par(las=1)
ggplot(b_data, aes(b, b_rs , fill = category)) +
geom_bar(stat="identity", position = "dodge") +
scale_fill_brewer(palette = "Set1") + labs(y="Amount (in Crores)",
x="") + ggtitle("Amount Recieved and Spent by each Block from 2015-19")
library(ggplot2)
ggplot(b_data, aes(b, b_rs , fill = category)) +
geom_bar(stat="identity", position = "dodge") +
scale_fill_brewer(palette = "Set1") + labs(y="Amount (in Crores)",
x="") +
theme(axis.text.x=element_text(angle=90, hjust=1)) +
ggtitle("Amount Recieved and Spent by each Block from 2015-19")
